(function(){var c=[],a=[];c[0]="Dimanche";c[1]="Lundi";c[2]="Mardi";c[3]="Mercredi";c[4]="Jeudi";c[5]="Vendredi";c[6]="Samedi";a[0]="janvier";a[1]="f\u00e9vrier";a[2]="mars";a[3]="avril";a[4]="mai";a[5]="juin";a[6]="juillet";a[7]="ao\u00fbt";a[8]="septembre";a[9]="octobre";a[10]="novembre";a[11]="d\u00e9cembre";Date.prototype.daysArray=c;Date.prototype.monthsArray=a;String.prototype.dateFromDotNet=function(){var b=this.substring(6,this.length-2);return new Date(parseInt(b))};Date.prototype.toTimeString=
function(b){var a=10>this.getHours()?"0"+this.getHours():this.getHours(),c=10>this.getMinutes()?"0"+this.getMinutes():this.getMinutes();return[a,c].join(b)};Date.prototype.toFR=function(b){var a=["Le",this.daysArray[this.getDay()],this.getDate(),this.monthsArray[this.getMonth()],this.getFullYear()];b&&(b=this.toTimeString(":"),a.push("\u00e0",b));return a.join(" ")};Date.prototype.toIlya=function(){var b=new Date-this,a=[],c,d;6E4>b?a.push("Il y a quelques secondes"):36E5>b?(b=Math.round(b/1E3/60),
a.push("Il y a",b),a.push(1<b?"minutes":"minute")):72E5>b?a.push("Il y a environ une heure"):864E5>b?(b=this.toFR(!0),c=b.indexOf("\u00e0"),a.push("Hier,",b.substr(c))):6048E5>b?(b=this.toFR(!0),c=b.indexOf("\u00e0"),d=[b.split(" ")[1],","],a.push(d.join(""),b.substr(c))):a.push(this.toFR(!0));return a.join(" ")}})();(function(){var c={actus:{get:function(a,b){var e={};if("string"==typeof a&&"number"==typeof b){var f,e=[];if(""!=a||0<b)f=!0,""!=a&&e.push("redacteur=",encodeURIComponent(a),"&"),0<b&&e.push("nb_news=",b);e=JSON.parse(c.tools.executeSyncRequest("POST","http://www.pcinpact.com/ReadApi/ListActu",e.join(""),f));c.tools.logMessage("Actualit\u00e9s r\u00e9cup\u00e9r\u00e9es");for(var d in e.List){f=e.List[d].PublishDate.dateFromDotNet();var g=f.toFR(!1);e.List[d].PublishDate={date:g,time:f.toTimeString(":"),
old_format:e.List[d].PublishDate}}c.tools.logMessage("Mise en forme de la date et compteurs sociaux : OK");e.lastUpdateDate=(new Date).toString()}else throw"Impossible de rappatrier les actualit\u00e9s. Un des param\u00e8tres indiqu\u00e9 n'\u00e9tait pas valide";return e},check:function(){c.tools.logMessage("V\u00e9rification des actualit\u00e9s en cours",!1);var a=c.actus.get("",0),b={};if(localStorage.PCiActusLastCheck){var b=JSON.parse(localStorage.PCiActusLastCheck),e=[];if(a.List[0].Id!=b.List[0].Id||
a.NbNews!=b.NbNews)for(var f in a.List){var d=a.List[f],g=b.List,i=!0,h=void 0;for(h in g)if(g[h].Id==d.Id&&g[h].PublishDate.old_format==d.PublishDate.old_format){i=!1;break}i&&e.push(a.List[f])}b={list:e};0<e.length&&c.tools.logMessage(e.length+" nouveau(x) contenu(s) d\u00e9tect\u00e9(s)",!1)}else c.tools.logMessage("Premi\u00e8re v\u00e9rification des actualit\u00e9s",!1);localStorage.PCiActusLastCheck=JSON.stringify(a);b.lastUpdateDate=(new Date).toString();return b}},forum:{get:function(a){c.tools.executeAsyncRequestV2("GET",
"http://forum.pcinpact.com/","document",function(b){c.tools.logMessage("Contenu du forum r\u00e9cup\u00e9r\u00e9",!1);var e=b.response.getElementById("user_link"),f=b.response.getElementById("index_stats").getElementsByClassName("bbc_member")[0],d=f.href;if(null!=e){var g=b.response.getElementById("inbox_link"),b=b.response.getElementById("notify_link");"%C2%A0"==encodeURIComponent(g.innerText)&&(g.innerText="0");"%C2%A0"==encodeURIComponent(b.innerText)&&(b.innerText="0");var i=g.href,h=b.href;localStorage[a]=
JSON.stringify({gagnant:{name:f.innerText,url:d},messages:{count:parseInt(g.innerText),url:i},notifications:{count:parseInt(b.innerText),url:h},user:{name:e.innerText,url:e.href},is_connected:!0,last_update_date:(new Date).toString()});c.tools.logMessage("Informations du forum en cache - Utilisateur connect\u00e9",!1)}else localStorage[a]=JSON.stringify({gagnant:{name:f.innerText,url:d},is_connected:!1,last_update_date:(new Date).toString()}),c.tools.logMessage("Informations du forum en cache - Utilisateur d\u00e9connect\u00e9",
!1)})}},user:{get:function(){var a={},a=JSON.parse(c.tools.executeSyncRequest("POST","http://www.pcinpact.com/ReadApi/UserInfo","",!1));a.lastUpdateDate=(new Date).toString();a.error=!1;return a}}};window.PCi||(window.PCi=c)})();(function(){var c={getBonsPlans:function(){PCi.tools.executeAsyncRequestV2("GET","http://www.prixdunet.com/bon-plan.html?motcle=&type=0&order=nb_lectures&way=desc","document",function(a){for(var b="",c=[],f=a.response.getElementById("list_bp").getElementsByClassName("bp_table"),a=a.response.getElementById("list_bp").getElementsByClassName("bp_titre"),d=0;d<a.length;d++)b={titre:a[d].getElementsByTagName("a")[0].innerText,date:a[d].getElementsByTagName("span")[0].innerText,categorie:{img:f[d].getElementsByTagName("img")[0].src,
url:f[d].getElementsByTagName("a")[0].href},url:a[d].getElementsByTagName("a")[0].href},c.push(b),b={list:c,lastUpdateDate:(new Date).toString(),error:!1};localStorage.PdNBonsPlansLastCheck=JSON.stringify(b)})}};window.PdN||(window.PdN=c)})();(function(){var c;c={getQRCodeURL:function(a,b){return["http://api.qrserver.com/v1/create-qr-code/?size=",b,"x",b,"&data=",encodeURI(a)].join("")},getSocialCount:function(a){var b=JSON.parse(c.executeSyncRequest("GET","https://graph.facebook.com/?ids="+a,!1)).shares,a=JSON.parse(c.executeSyncRequest("GET","http://urls.api.twitter.com/1/urls/count.json?url="+a,!1)).count,e=c.stringToInt(b)+c.stringToInt(a);return{facebook:b,twitter:a,total:e}},executeSyncRequest:function(a,b,c,f){var d=new XMLHttpRequest;
f&&d.setRequestHeader("Content-Type', 'application/x-www-form-urlencoded");d.open(a,b,!1);d.send(c);return d.responseText},executeAsyncRequestV2:function(a,b,c,f){var d=new XMLHttpRequest;d.open(a,b,!0);d.responseType=c;d.onload=function(){200==this.status&&f(this)};d.send(null)},logMessage:function(a,b){if(localStorage.PCiEnableLog||b){var c=[];b&&c.push("### Erreur ###");c.push((new Date).toFR(!0),"-",a);console.log(c.join(" "))}},stringToInt:function(a){var b=0;a&&(b=parseInt(a));return b},urlToLocalBlob:function(a){c.executeAsyncRequestV2("GET",
a,"arraybuffer",function(a){var c=new FileReader,f=new WebKitBlobBuilder;f.append(a.response);c.readAsDataURL(f.getBlob("image/png"));c.onload=function(a){localStorage.qrCodeBlob=a.target.result}})}};window.PCi&&!window.PCi.tools&&(window.PCi.tools=c)})();

(function(){var b=[],a=[];b[0]="Dimanche";b[1]="Lundi";b[2]="Mardi";b[3]="Mercredi";b[4]="Jeudi";b[5]="Vendredi";b[6]="Samedi";a[0]="janvier";a[1]="f\u00e9vrier";a[2]="mars";a[3]="avril";a[4]="mai";a[5]="juin";a[6]="juillet";a[7]="ao\u00fbt";a[8]="septembre";a[9]="octobre";a[10]="novembre";a[11]="d\u00e9cembre";Date.prototype.daysArray=b;Date.prototype.monthsArray=a;String.prototype.dateFromDotNet=function(){var d=this.substring(6,this.length-2);return new Date(parseInt(d))};Date.prototype.toTimeString=
function(d){var a=10>this.getHours()?"0"+this.getHours():this.getHours(),b=10>this.getMinutes()?"0"+this.getMinutes():this.getMinutes();return[a,b].join(d)};Date.prototype.toFR=function(a){var c=["Le",this.daysArray[this.getDay()],this.getDate(),this.monthsArray[this.getMonth()],this.getFullYear()];a&&(a=this.toTimeString(":"),c.push("\u00e0",a));return c.join(" ")};Date.prototype.toIlya=function(){var a=new Date-this,c=[];if(6E4>a)c.push("Il y a quelques secondes");else if(36E5>a)a=Math.round(a/
1E3/60),c.push("Il y a",value),c.push(1<a?"minutes":"minute");else if(72E5>a)c.push("Il y a environ une heure");else if(864E5>a){var a=this.toFR(!0),b=a.indexOf("\u00e0");c.push("Hier,",a.substr(b))}else if(6048E5>a){var a=this.toFR(!0),b=a.indexOf("\u00e0"),e=[a.split(" ")[1],","];c.push(e.join(""),a.substr(b))}else c.push(this.toFR(!0));return c.join(" ")}})();(function(){var b={actus:{get:function(a,d){var c={};if("string"==typeof a&&"number"==typeof d){var h,e=[];if(""!=a||0<d)h=!0,""!=a&&e.push("redacteur=",encodeURIComponent(a),"&"),0<d&&e.push("nb_news=",d);try{c=JSON.parse(b.tools.executeSyncRequest("POST","http://www.pcinpact.com/ReadApi/ListActu",e.join(""),h));b.tools.logMessage("Actualit\u00e9s r\u00e9cup\u00e9r\u00e9es");for(var g in c.List){var f=c.List[g].PublishDate.dateFromDotNet(),i=f.toFR(!1);c.List[g].PublishDate={date:i,time:f.toTimeString(":"),
old_format:c.List[g].PublishDate}}b.tools.logMessage("Mise en forme de la date et compteurs sociaux : OK");c.lastUpdateDate=(new Date).toString();c.error=!1}catch(j){c={error:!0,message:j.message},b.tools.logMessage(j.message,!0)}}else c={error:!0,message:"Un des param\u00e8tres indiqu\u00e9 n'\u00e9tait pas valide"};return c},check:function(){b.tools.logMessage("V\u00e9rification des actualit\u00e9s en cours",!1);var a=b.actus.get("",0),d={};if(a.error)d={error:!0,message:"Une erreur est intervenue durant la v\u00e9rification des actualit\u00e9s"},
b.tools.logMessage(d.message,d.error);else{if(localStorage.PCiActusLastCheck){var d=JSON.parse(localStorage.PCiActusLastCheck),c=[];if(a.List[0].Id!=d.List[0].Id||a.NbNews!=d.NbNews)for(var h in a.List){var e=a.List[h],g=d.List,f=!0,i=void 0;for(i in g)if(g[i].Id==e.Id&&g[i].PublishDate.old_format==e.PublishDate.old_format){f=!1;break}f&&c.push(a.List[h])}d={list:c};0<c.length&&b.tools.logMessage(c.length+" nouveau(x) contenu(s) d\u00e9tect\u00e9(s)",!1)}else b.tools.logMessage("Premi\u00e8re v\u00e9rification des actualit\u00e9s",
!1);localStorage.PCiActusLastCheck=JSON.stringify(a);d.lastUpdateDate=(new Date).toString();d.error=!1}return d}},forum:{get:function(a){try{b.tools.executeAsyncRequestV2("GET","http://forum.pcinpact.com/","document",function(c){b.tools.logMessage("Contenu du forum r\u00e9cup\u00e9r\u00e9",!1);var d=c.response.getElementById("user_link"),e=c.response.getElementById("index_stats").getElementsByClassName("bbc_member")[0],g=e.href;if(null!=d){var f=c.response.getElementById("inbox_link"),c=c.response.getElementById("notify_link");
"%C2%A0"==encodeURIComponent(f.innerText)&&(f.innerText="0");"%C2%A0"==encodeURIComponent(c.innerText)&&(c.innerText="0");var i=f.href,j=c.href;localStorage[a]=JSON.stringify({gagnant:{name:e.innerText,url:g},messages:{count:parseInt(f.innerText),url:i},notifications:{count:parseInt(c.innerText),url:j},user:{name:d.innerText,url:d.href},is_connected:!0,last_update_date:(new Date).toString()});b.tools.logMessage("Informations du forum en cache - Utilisateur connect\u00e9",!1)}else localStorage[a]=
JSON.stringify({gagnant:{name:e.innerText,url:g},is_connected:!1,last_update_date:(new Date).toString()}),b.tools.logMessage("Informations du forum en cache - Utilisateur d\u00e9connect\u00e9",!1)})}catch(d){b.tools.logMessage(d.message,!0)}}},user:{get:function(){var a={};try{a=JSON.parse(b.tools.executeSyncRequest("POST","http://www.pcinpact.com/ReadApi/UserInfo","",!1)),a.lastUpdateDate=(new Date).toString(),a.error=!1}catch(d){a={error:!0,message:d.message},b.tools.logMessage(d.message,!0)}return a}}};
window.PCi||(window.PCi=b)})();(function(){var b={getBonsPlans:function(){PCi.tools.executeAsyncRequestV2("GET","http://www.prixdunet.com/bon-plan.html?motcle=&type=0&order=nb_lectures&way=desc","document",function(a){var d,c=[];try{for(var b=a.response.getElementById("list_bp").getElementsByClassName("bp_table"),e=a.response.getElementById("list_bp").getElementsByClassName("bp_titre"),a=0;a<e.length;a++){var g={titre:e[a].getElementsByTagName("a")[0].innerText,date:e[a].getElementsByTagName("span")[0].innerText,categorie:{img:b[a].getElementsByTagName("img")[0].src,
url:b[a].getElementsByTagName("a")[0].href},url:e[a].getElementsByTagName("a")[0].href};c.push(g);d={list:c,lastUpdateDate:(new Date).toString(),error:!1}}}catch(f){d={error:!0,message:f.message},PCi.tools.logMessage(f.message,!0)}localStorage.PdNBonsPlansLastCheck=JSON.stringify(d)})}};window.PdN||(window.PdN=b)})();(function(){var b;b={getSocialCount:function(a){var d=JSON.parse(b.executeSyncRequest("GET","https://graph.facebook.com/?ids="+a,!1)).shares,a=JSON.parse(b.executeSyncRequest("GET","http://urls.api.twitter.com/1/urls/count.json?url="+a,!1)).count,c=b.stringToInt(d)+b.stringToInt(a);return{facebook:d,twitter:a,total:c}},executeSyncRequest:function(a,d,c,b){var e=new XMLHttpRequest;b&&xmlhttp.setRequestHeader("Content-Type', 'application/x-www-form-urlencoded");e.open(a,d,!1);e.send(c);return e.responseText},
executeAsyncRequestV2:function(a,b,c,h){var e=new XMLHttpRequest;e.open(a,b,!0);e.responseType=c;e.onload=function(){200==this.status&&h(this)};e.send(null)},logMessage:function(a,b){if(localStorage.PCiEnableLog||b){var c=[];b&&c.push("### Erreur ###");c.push((new Date).toFR(!0),"-",a);console.log(c.join(" "))}},stringToInt:function(a){var b=0;a&&(b=parseInt(a));return b},urlToLocalBlob:function(a){b.executeAsyncRequestV2("GET",a,"arraybuffer",function(a){try{var c=new FileReader,h=new WebKitBlobBuilder;
h.append(a.response);c.readAsDataURL(h.getBlob("image/png"));c.onload=function(a){localStorage.qrCodeBlob=a.target.result}}catch(e){b.logMessage(e.message,!0)}})}};window.PCi&&!window.PCi.tools&&(window.PCi.tools=b)})();
